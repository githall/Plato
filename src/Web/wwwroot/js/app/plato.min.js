if(typeof jQuery=="undefined")throw new Error("Plato requires jQuery");$(function(n,t,i){"use strict";var r={info:"Info",warning:"Warning",error:"Error",prevLogDate:null,logInfo:function(n){this.log(this.info,n)},logWarning:function(n){this.log(this.warning,n)},logError:function(n){this.log(this.error,n)},log:function(n,t){if(i.Plato.defaults.debug){var r=this.getDifferenceInMilliseconds();this.prevLogDate=new Date;console.log(n+": "+t+" - "+r+"ms elapsed since previous log entry.")}},getDifferenceInMilliseconds:function(){if(this.prevLogDate===null)this.prevLogDate=new Date;else return(this.prevLogDate-new Date)/1e4;return 0}},u={init:function(){if(n.$.Plato.defaults===null)throw new Error("win.$.Plato.defaults Required");if(r.logInfo("Initializing platoLocale"),n.$.Plato.defaults.locale===""){r.logError("platoLocale could not be initialized as the $.Plato.defaults.locale property is empty!");return}var t="/js/app/locale/app."+n.$.Plato.defaults.locale+".js";r.logInfo("Starting to load locale: "+t);this._load(t);r.logInfo("Finished loading locale: "+t)},get:function(t){var i=n.$.Plato.Strings;return typeof i!="undefined"&&typeof i[t]!="undefined"?i[t]:t},_load:function(n){var i=document.getElementsByTagName("head"),u=parseInt(Math.random()*1e3)+(new Date).getTime(),t=document.createElement("script");t.setAttribute("src",n+"?v="+u);i&&(i[0].appendChild(t),r.logInfo("Adding locale ("+n+") to the head element."));t.onLoad=function(){r.logInfo("Added locale ("+n+") to the head element.")}}},f={init:function(n){n||(n=i("body"));this.initToolTips(n);this.initDropDowns(n);this.initAvatar(n)},logInfo:function(n){r.logInfo(n)},logError:function(n){r.logError(n)},initToolTips:function(t){t||(t=i("body"));this.logInfo("initToolTips()");n.$.Plato.defaults.bsToolTipEnabled&&(t&&(t.find(n.$.Plato.defaults.bsToolTipSelector).tooltip({trigger:"hover"}),t.find(n.$.Plato.defaults.bsToolTipAlternativeSelector).tooltip({trigger:"hover"})),this.logInfo("Bootstrap tooltips initialized."))},disposeToolTips:function(t){n.$.Plato.defaults.bsToolTipEnabled&&(t&&(t.find(n.$.Plato.defaults.bsToolTipSelector).tooltip("dispose"),t.find(n.$.Plato.defaults.bsToolTipAlternativeSelector).tooltip("dispose")),this.logInfo("Bootstrap tooltips disposed."))},initDropDowns:function(n){n||(n=i("body"));this.logInfo("initDropDowns()");n.find("ul.dropdown-menu [data-toggle='dropdown']").on("click",function(n){n.preventDefault();n.stopPropagation();i("ul.dropdown-menu [data-toggle='dropdown']").parent().removeClass("show");i(this).parent().addClass("show")})},initAvatar:function(t){t||(t=i("body"));this.logInfo("initAvatar()");t.find(n.$.Plato.defaults.avatarUploadSelector).change(function(){function n(n){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(t){var u=i(n).attr("data-upload-preview-selector"),r=i(u).find("span");r.css("background-image"," url("+t.target.result+")");r.hide().fadeIn(650)};t.readAsDataURL(n.files[0])}}n(this)})},notify:function(n,t){i.notify(n,t)}},e=function(t){var e,o;if(!n.$.Plato.defaults)throw new Error("platoHttp requires a valid $.Plato.defaults object");return e=n.$.Plato.defaults.apiKey,e?(r.logInfo("ApiKey: "+e),t.beforeSend=function(n){n.setRequestHeader("Authorization","Basic "+e)}):r.logInfo("No API key was supplied"),t.headers={"Content-Type":"application/json; charset=utf-8","X-Api-Version":"1","X-Csrf-Token":n.$.Plato.defaults.getCsrfCookieToken()},o=function(){var o=function(n){var t="<h6>"+u.get("An error occurred!")+"<\/h6>";return t+=u.get("Information is provided below...")+"<br/><br/>",t+('<textarea style="min-height: 130px;" class="form-control">'+n+"<\/textarea>")},n=function(n){f.notify({message:n},{mouse_over:"pause",type:"danger",allow_dismiss:!0})},t=function(t,i,u,f){var e="$.Plato.Http - "+f+"\n"+JSON.stringify(i,null,"     ");r.logError(e);n(o(e))},e=function(t){switch(t.statusCode){case 401:n("<h6>"+u.get("Could not authenticate your request!")+"<\/h6>");break;case 404:n("<h6>"+u.get("404 - Service Not Found!")+"<\/h6>")}r.logInfo("platoHttp - Completed: "+JSON.stringify(t,null,"     "))};return{promise:function(n){return i.ajax(n).fail(function(i,r,u){if(i&&i.readyState!==null&&typeof i.readyState!="undefined"){var f=parseInt(i.readyState);if(!isNaN(f)&&f===0)return}if(t&&t(n,i,r,u),n.onError)n.onError(i,r,u)}).always(function(t,i){if(e&&e(t,i),n.onAlways)n.onAlways(t,i)})}}}(),r.logInfo("$.Plato.Http - Starting Request: "+JSON.stringify(t,null,"     ")),o.promise(t)},o={setCookie:function(n,t,i,r,u){var e,f;return r=r||!1,r&&(t=encodeURIComponent(JSON.stringify(t))),u||(u="/"),e="",i&&(f=new Date,f.setTime(f.getTime()+864e5*i),e="; expires="+f.toGMTString()),document.cookie=n+"="+t+e+";path="+u,this},getCookie:function(n){var r=n+"=",u=document.cookie.indexOf(r),i,t;return u!==-1?(i=u+r.length,t=document.cookie.indexOf(";",i),t===-1&&(t=document.cookie.length),unescape(document.cookie.substring(i,t))):null},updateCookie:function(n,t,i,r){var o=this.getCookie(n),f=[],u,e;if(r=r||",",o){u=o.split(r);for(e in u)u.hasOwnProperty(e)&&u[e]!==t&&u[e]!==""&&(f[f.length]=u[e])}return i&&(f[f.length]=t),this.setCookie(n,f.join(r)),this},clearCookie:function(n){return this.setCookie(n,null,-1),this},set:function(t,i){n.localStorage&&n.localStorage.setItem(t,i)},get:function(t){return n.localStorage?n.localStorage.getItem(t):null},remove:function(t){n.localStorage&&n.localStorage.removeItem(t)}},s={htmlEncode:function(n){var t=document.createElement("span");return t.textContent=n,t.innerHTML}},h={init:function(){var n,i=t.getElementsByTagName("script")[0],r=t.createDocumentFragment(),u=function(i,u){t.getElementById(u)||(n=t.createElement("script"),n.src=i,u&&(n.id=u),r.appendChild(n))};u("https://connect.facebook.net/en_US/sdk.js","facebook-jssdk");u("https://platform.twitter.com/widgets.js");i.parentNode.insertBefore(r,i)},facebook:{init:function(t){if(t===null||typeof t=="undefined"||t==="")return null;n.fbAsyncInit=function(){n.FB.init({appId:t,xfbml:!0,version:"v2.8"})}},share:function(t){n.FB.ui({method:"share",href:t},function(n){n&&n.post_id})},feed:function(t){n.FB.ui({method:"feed",name:"",link:t,picture:"",caption:"",description:""},function(n){n&&n.post_id})}},twitter:{share:function(t){n.twttr.ready(function(n){n.events.bind("tweet",function(){})});var i=window.open("https://twitter.com/intent/tweet?text="+t,"popupwindow","scrollbars=yes,width=800,height=400");i.focus()}}},c={addCss:function(n){var r=t.head,i;r&&(i=t.createElement("link"),i.type="text/css",i.rel="stylesheet",i.href=n,r.appendChild(i))},addScript:function(n){var r=t.body,i;r&&(i=t.createElement("script"),i.src=n,r.appendChild(i))}};n.$.Plato={defaults:{debug:!0,pathBase:"",locale:"en-US",apiKey:"",csrfHeaderName:"X-Csrf-Token",csrfCookieName:"",bsToolTipEnabled:!0,bsToolTipAlternativeSelector:"[data-provide='tooltip']",bsToolTipSelector:"[data-toggle='tooltip']",avatarUploadSelector:"[data-upload='avatar']",alerts:{autoClose:!0,autoCloseDelay:8},layout:{stickyHeaders:!0,stickySideBars:!0},validation:{scrollToErrors:!0},getCsrfCookieToken:function(){if(this.csrfCookieName!==""){var i=n.$.Plato.storage,t=i.getCookie(this.csrfCookieName);if(t)return t}return""}},T:function(n){return this.locale?this.locale.get(n):n},readyMethods:[],loadMethods:[],ready:function(n){this.readyMethods.push(n)},load:function(n){this.loadMethods.push(n)},locale:u,logger:r,ui:f,http:e,storage:o,text:s,social:h,utils:c};i(t).ready(function(){for(var t=n.$.Plato,i=0;i<t.readyMethods.length;i++)t.readyMethods[i]();t.logger.logInfo("$.Plato:\n"+JSON.stringify(t.defaults,null,"     "));t.ui.init()});i(n).on("load",function(){var i,t;for(("serviceWorker"in n.navigator)&&n.navigator.serviceWorker.register("/service-worker.js"),i=n.$.Plato,t=0;t<i.loadMethods.length;t++)i.loadMethods[t]()})}(window,document,jQuery));