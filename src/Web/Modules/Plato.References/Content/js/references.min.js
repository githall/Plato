if(typeof jQuery=="undefined")throw new Error("jQuery 3.3.1 or above Required");if(typeof window.$.Plato=="undefined")throw new Error("$.Plato Required");if(typeof window.$.fn.platoUI=="undefined")throw new Error("$.Plato UI Required");$(function(n,t,i){"use strict";var r=n.$.Plato,u=function(){var t="references",f=t+"Id",r={},u={init:function(n,t,i){if(t){this[t]?this[t].apply(this,[n,i]):alert(t+" is not a valid method!");return}this.bind(n)},bind:function(u){var f="#";u.suggester(i.extend(u.data(t)),{keys:[{match:/(^|\s|\()(#{1}([a-z0-9\-_/]*))$/i,search:function(n,t){for(var r=n.val().split(""),e=null,u=-1,s=t.start-1,o,i=s;i>=0;i--)if(r[i]===f){u=i;break}else if(r[i]==="\n"||r[i]===" ")break;if(o=u>0?r[u-1]:"",o===f&&(u=-1,e=null),u>=0)for(e="",i=u;i<=r.length-1;i++){if(r[i]==="\n"||r[i]===" ")break;e+=r[i]}return{startIndex:u,value:e}},bind:function(t,i){var r=i.value;r&&(r.substring(0,1)===f&&(r=r.substring(1,r.length)),u.suggester({page:1,pageSize:5,itemSelection:{enable:!0,index:0,css:"active"},valueField:"keywords",config:{method:"GET",url:n.$.Plato.defaults.pathBase+"/api/search/get?page={page}&size={pageSize}&keywords="+encodeURIComponent(r),data:{sort:"ModifiedDate",order:"Desc"}},itemCss:"dropdown-item",itemTemplate:'<a class="{itemCss}" href="{url}"><div style="display:inline-block; width: 85%; overflow:hidden; text-overflow: ellipsis;"><span class="avatar avatar-sm mr-2"><span style="background-image: url({createdBy.avatar.url});"><\/span><\/span>{title}<\/div>{relevance}<\/a>',parseItemTemplate:function(n,t){return n=t.id?n.replace(/\{id}/g,t.id):n.replace(/\{id}/g,"0"),n=t.title?n.replace(/\{title}/g,t.title):n.replace(/\{title}/g,"(no title)"),n=t.excerpt?n.replace(/\{excerpt}/g,t.userName):n.replace(/\{excerpt}/g,"(no excerpt)"),n=t.url?n.replace(/\{url}/g,t.url):n.replace(/\{url}/g,"#"),n=t.relevance?t.relevance>0?n.replace(/\{relevance}/g,'<span class="float-right badge badge-primary" data-provide="tooltip" title="Relevancy">'+t.relevance+"%<\/span>"):n.replace(/\{relevance}/g,""):n.replace(/\{relevance}/g,""),t.createdBy&&t.createdBy.avatar&&(n=t.createdBy.avatar.url?n.replace(/\{createdBy.avatar.url}/g,t.createdBy.avatar.url):n.replace(/\{createdBy.avatar.url}/g,"#")),t.modifiedBy&&t.modifiedBy.avatar&&(n=t.modifiedBy.avatar.url?n.replace(/\{modifiedBy.avatar.url}/g,t.modifiedBy.avatar.url):n.replace(/\{modifiedBy.avatar.url}/g,"#")),t.lastReplyBy&&t.lastReplyBy.avatar&&(n=t.lastReplyBy.avatar.url?n.replace(/\{lastReplyBy.avatar.url}/g,t.lastReplyBy.avatar.url):n.replace(/\{lastReplyBy.avatar.url}/g,"#")),n},onPagerClick:function(n,t,i){i.preventDefault();i.stopPropagation();u.suggester({page:t},"show")},onItemClick:function(n,t,r){r.preventDefault();u.focus().suggester("hide").suggester({insertData:{index:i.startIndex,value:t.id+"("+t.title+")"}},"insert")}},"show"))},unbind:function(){u.suggester("hide")}}]},r)}};return{init:function(){for(var e,h,o={},n=null,c=null,s=0;s<arguments.length;++s)if(e=arguments[s],e)switch(e.constructor){case Object:i.extend(o,e);break;case String:n=e;break;case Function:c=e}if(this.length>0)return this.each(function(){if(i(this).data(f))i(this).data(t,i.extend({},i(this).data(t),o));else{var e=t+parseInt(Math.random()*100)+(new Date).getTime();i(this).data(f,e);i(this).data(t,i.extend({},r,o))}u.init(i(this),n,c)});n&&(u[n]?(h=i("body"),h.data(t,i.extend({},r,o)),u[n].apply(this,[h])):alert(n+" is not a valid method!"))}}}();i.fn.extend({references:u.init});r.ready(function(){i('[data-provide="references"]').references();i(".md-textarea").references();i(".md-textarea").keyBinder("bind")})}(window,document,jQuery));