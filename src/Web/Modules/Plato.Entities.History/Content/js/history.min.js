if(typeof $().modal=="undefined")throw new Error("BootStrap 4.1.1 or above Required");if(typeof window.$.Plato=="undefined")throw new Error("$.Plato Required");$(function(n,t,i){"use strict";var r=n.$.Plato,u=function(){var t="history",f=t+"Id",e={entityId:0,entityReplyId:0,dialogUrl:null},u={init:function(n,t){if(t){this[t]?this[t].apply(this,[n]):alert(t+" is not a valid method!");return}this.bind(n)},bind:function(t){var o=this.getEntityId(t),s=this.getEntityReplyId(t),f=this.getDialogUrl(t),u="?page={page}&size={pageSize}&entityId={entityId}&entityReplyId={entityReplyId}",e;if(f===null)throw new Error("The history menu requires a data-dialog-url attribute");u=u.replace(/\{entityId}/g,o);u=u.replace(/\{entityReplyId}/g,s);e=r.T("No history available");t.pagedList({page:1,pageSize:50,enablePaging:!0,loaderTemplate:null,itemSelection:{enable:!1,index:0,css:"active"},noResultsIcon:null,noResultsText:e,config:{method:"GET",url:n.$.Plato.defaults.pathBase+"/api/history/entity/get"+u,data:{sort:"CreatedDate",order:1}},itemCss:"dropdown-item p-2",itemTemplate:'<a data-history-id="{id}" class="{itemCss}" href="{url}"><span class="list-left list-left-sm"><span class="avatar avatar-sm" data-toggle="tooltip" title="{createdBy.displayName}"><span style="background-image: url({createdBy.avatar.url}"><\/span><\/span><\/span><span class="list-body"><span class="float-right">{version}<\/span>{text}<\/span><\/a>',parseItemTemplate:function(n,t){return n=t.id?n.replace(/\{id}/g,t.id):n.replace(/\{id}/g,"0"),n=t.text?n.replace(/\{text}/g,t.text):n.replace(/\{text}/g,""),n=t.version?n.replace(/\{version}/g,t.version):n.replace(/\{version}/g,""),n=t.createdBy.id?n.replace(/\{createdBy.id}/g,t.createdBy.id):n.replace(/\{createdBy.id}/g,""),n=t.createdBy.displayName?n.replace(/\{createdBy.displayName}/g,t.createdBy.displayName):n.replace(/\{createdBy.displayName}/g,""),n=t.createdBy.url?n.replace(/\{createdBy.url}/g,t.createdBy.url):n.replace(/\{createdBy.url}/g,""),n=t.createdBy.avatar.url?n.replace(/\{createdBy.avatar.url}/g,t.createdBy.avatar.url):n.replace(/\{createdBy.avatar.url}/g,""),n=t.date.value?n.replace(/\{date.value}/g,t.date.value):n.replace(/\{date.value}/g,""),n.replace(/\{url}/g,f.replace("0",t.id))},onItemClick:function(n,t,r,u){r.preventDefault();r.stopPropagation();i().dialog({id:"historyDialog",body:{url:u.attr("href")},css:{modal:"modal fade",dialog:"modal-dialog modal-lg"}},"show")},onLoaded:function(){r.ui.initToolTips(t)}})},update:function(n){n.pagedList("unbind")},getEntityId:function(n){var r=typeof n.data("entityId")!="undefined"&&n.data("entityId")!==null?n.data("entityId"):n.data(t).entityId,i;return r!==null&&(i=parseInt(r),!isNaN(i))?i:0},getEntityReplyId:function(n){var r=typeof n.data("entityReplyId")!="undefined"&&n.data("entityReplyId")!==null?n.data("entityReplyId"):n.data(t).entityReplyId,i;return r!==null&&(i=parseInt(r),!isNaN(i))?i:0},getDialogUrl:function(n){return typeof n.data("dialogUrl")!="undefined"&&n.data("dialogUrl")!==null?n.data("dialogUrl"):n.data(t).dialogUrl}};return{init:function(){for(var r,h,o={},n=null,s=0;s<arguments.length;++s)if(r=arguments[s],r)switch(r.constructor){case Object:i.extend(o,r);break;case String:n=r}if(this.length>0)return this.each(function(){if(i(this).data(f))i(this).data(t,i.extend({},i(this).data(t),o));else{var r=t+parseInt(Math.random()*100)+(new Date).getTime();i(this).data(f,r);i(this).data(t,i.extend({},e,o))}u.init(i(this),n)});n&&(u[n]?(h=i("body"),h.data(t,i.extend({},e,o)),u[n].apply(this,[h])):alert(n+" is not a valid method!"))}}}(),f=function(){var n="historyDropdown",t=n+"Id",r={},u={init:function(n){this.bind(n)},bind:function(n){n.find(".dropdown-toggle").click(function(){n.find('[data-provide="history"]').history()})}};return{init:function(){var f={};return this.each(function(){if(i(this).data(t))i(this).data(n,i.extend({},i(this).data(n),f));else{var e=n+parseInt(Math.random()*1e3)+(new Date).getTime();i(this).data(t,e);i(this).data(n,i.extend({},r,f))}u.init(i(this))})}}}();i.fn.extend({history:u.init,historyDropdown:f.init});r.ready(function(){i('[data-provide="history-dropdown"]').historyDropdown()});i().infiniteScroll(function(n){n.find('[data-provide="history-dropdown"]').historyDropdown()},"ready")}(window,document,jQuery));