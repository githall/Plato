if(typeof jQuery=="undefined")throw new Error("jQuery 3.3.1 or above Required");if(typeof window.$.Plato=="undefined")throw new Error("$.Plato Required");if(typeof window.$.fn.platoUI=="undefined")throw new Error("$.Plato UI Required");$(function(n,t,i){"use strict";var r=n.$.Plato,u=function(){var t="reactions",f=t+"Id",e={tooltipEvent:"mouseenter",event:"click",params:{id:0,userId:0,entityId:0,entityReplyId:0,reactionName:""},data:{}},u={init:function(n,t){if(t){this[t]?this[t].apply(this,[n]):alert(t+" is not a valid method!");return}u.bind(n)},bind:function(n){n.find("a").each(function(){var r="";i(this).attr("data-toggle")?i(this).tooltip({trigger:"hover"}):(r=n.data(t).tooltipEvent,r&&i(this).unbind(r).bind(r,function(){var t=i(this).attr("data-reaction-description");t&&n.find(".text-muted").text(t)}));r=n.data(t).event;r&&i(this).unbind(r).bind(r,function(r){r.preventDefault();i(this).attr("data-toggle")&&i(this).tooltip("hide");n.data(t).params.reactionName=i(this).attr("data-reaction-name");u.post(n)})})},unbind:function(n){n.find("a").each(function(){var r=n.data(t).tooltipEvent;r&&i(this).unbind(r);r=n.data(t).event;r&&i(this).unbind(r)})},post:function(i){var f=i.data(t).params;f.entityId=this.getEntityId(i);f.entityReplyId=this.getEntityReplyId(i);r.http({url:n.$.Plato.defaults.pathBase+"/api/reactions/react/post",method:"POST",data:JSON.stringify(f)}).done(function(n){(n.statusCode===201||n.statusCode===202)&&n.result&&(i.data(t).data=n.result,u.refresh(i))})},refresh:function(n){var o=n.data(t).data,r=this.getTarget(n),f;if(r){if(r.empty(),o.length>0){for(f=0;f<o.length;f++){var e=o[f],s=i("<li>",{"class":"list-group-item  border-0"}),h=i("<a>",{href:"#","class":"list-group-item list-group-item-action py-2 px-3 border-0","data-toggle":"tooltip",title:e.toolTip,"data-reaction-name":e.name}),c=i("<span>",{"class":"d-inline-block mx-1"}).html(e.emoji),l=i("<span>",{"class":"d-inline-block mx-1"}).html(e.total);h.append(c).append(l);s.append(h);r.append(s)}r.hasClass("hidden")&&r.removeClass("hidden")}else r.hasClass("hidden")||r.addClass("hidden");u.bind(r)}},getEntityId:function(n){var t=0;if(n.attr("data-entity-id")&&(t=parseInt(n.attr("data-entity-id"))),t===0)throw new Error("A entity id is required in order to react to an entity");return t},getEntityReplyId:function(n){var t=0;return n.attr("data-entity-reply-id")&&(t=parseInt(n.attr("data-entity-reply-id"))),t},getTarget:function(n){var r=n.attr("data-reactions-target"),t;return r&&(t=i(r),t.length>0)?t:null}};return{init:function(){for(var r,h,o={},n=null,s=0;s<arguments.length;++s)if(r=arguments[s],r)switch(r.constructor){case Object:i.extend(o,r);break;case String:n=r}if(this.length>0)return this.each(function(){if(i(this).data(f))i(this).data(t,i.extend({},i(this).data(t),o));else{var r=t+parseInt(Math.random()*100)+(new Date).getTime();i(this).data(f,r);i(this).data(t,i.extend({},e,o))}u.init(i(this),n)});n&&(u[n]?(h=i("body"),h.data(t,i.extend({},e,o)),u[n].apply(this,[h])):alert(n+" is not a valid method!"))}}}();i.fn.extend({reactions:u.init});r.ready(function(){i('[data-provide="reactions"]').reactions()});i().infiniteScroll(function(n){n.find('[data-provide="reactions"]').reactions()},"ready")}(window,document,jQuery));